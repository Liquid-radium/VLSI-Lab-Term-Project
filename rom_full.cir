* 4-Word x 4-Bit ROM

* --- Power Supply ---
Vdd vdd 0 5

* --- Address Inputs (2-bit address generator) ---
Va a 0 PULSE(0 5 0 5n 5n 20n 40n)
Vb b 0 PULSE(0 5 0 5n 5n 40n 80n)

* --- Include Models ---
.include "t14y_tsmc_025_level3.txt"

* --- Include Decoder ---
.include "decoder.cir"

* --- Instantiate Decoder ---
Xdec a b Y0 Y1 Y2 Y3 Y0h Y1h Y2h Y3h vdd 0 DEC2to4

* =====================================================
* --- ROM CELLS (4 words × 4 bits) ---
* Format: Mname Drain Gate Source Bulk Model

* -------- Word 0 (Addr=00) = 1011 --------
M00 BL0 Y0h vdd vdd CMOSN W=2u L=1u
M01 BL1 Y0h 0   0 CMOSN W=2u L=1u
M02 BL2 Y0h vdd vdd CMOSN W=2u L=1u
M03 BL3 Y0h vdd vdd CMOSN W=2u L=1u

* -------- Word 1 (Addr=01) = 0101 --------
M10 BL0 Y1h 0   0 CMOSN W=2u L=1u
M11 BL1 Y1h vdd 0 CMOSN W=2u L=1u
M12 BL2 Y1h 0   0 CMOSN W=2u L=1u
M13 BL3 Y1h vdd 0 CMOSN W=2u L=1u

* -------- Word 2 (Addr=10) = 1100 --------
M20 BL0 Y2h vdd 0 CMOSN W=2u L=1u
M21 BL1 Y2h vdd 0 CMOSN W=2u L=1u
M22 BL2 Y2h 0   0 CMOSN W=2u L=1u
M23 BL3 Y2h 0   0 CMOSN W=2u L=1u

* -------- Word 3 (Addr=11) = 0010 --------
M30 BL0 Y3h 0   0 CMOSN W=2u L=1u
M31 BL1 Y3h 0   0 CMOSN W=2u L=1u
M32 BL2 Y3h vdd 0 CMOSN W=2u L=1u
M33 BL3 Y3h 0   0 CMOSN W=2u L=1u

* =====================================================
* --- Output Buffers (per bitline) ---
* Bitline BL → Output OUT (via inverter)
Mp0 OUT0 BL0 vdd vdd CMOSN W=4u L=1u
Mn0 OUT0 BL0 0   0   CMOSP W=2u L=1u

Mp1 OUT1 BL1 vdd vdd CMOSN W=4u L=1u
Mn1 OUT1 BL1 0   0   CMOSP W=2u L=1u

Mp2 OUT2 BL2 vdd vdd CMOSN W=4u L=1u
Mn2 OUT2 BL2 0   0   CMOSP W=2u L=1u

Mp3 OUT3 BL3 vdd vdd CMOSN W=4u L=1u
Mn3 OUT3 BL3 0   0   CMOSP W=2u L=1u

* =====================================================
* --- Simulation ---
.tran 1n 400n
.probe v(a) v(b) v(Y0h) v(Y1h) v(Y2h) v(Y3h) v(OUT0) v(OUT1) v(OUT2) v(OUT3)

.control
run
* stacked plots for clarity
plot v(a) v(b)+6 v(Y0h)+12 v(Y1h)+18 v(Y2h)+24 v(Y3h)+30
plot v(OUT0) v(OUT1)+6 v(OUT2)+12 v(OUT3)+18
.endc
.end
